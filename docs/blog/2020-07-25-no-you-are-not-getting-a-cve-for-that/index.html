<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width,minimum-scale=1,maximum-scale=1">

  
    
    
      <link href="/css/fonts.css" rel="stylesheet" type="text/css">
    
  

  
  <title>No, You Are Not Getting a CVE for That</title>

  
  
  <link rel="stylesheet" href="/css/hugo-octopress.css">

  
  

  
    <link rel="stylesheet" href="/css/fork-awesome.min.css">
  

  
  <link href="http://localhost:1313/favicon.png" rel="icon">

  
  

  <meta name="description" content="" />
  <meta name="keywords" content="[Parsia Hakimian Parsiya infosec information security]">
  <meta name="author" content="Parsia">

  
  <meta name="generator" content="Hugo 0.83.1" />

  
  

  
  
    

  
  
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:image:src" content="http://localhost:1313/blog/2020-07-25-no-you-are-not-getting-a-cve-for-that/01-goodnews.png"/>
  
  
  <meta name="twitter:title" content="No, You Are Not Getting a CVE for That"/>
  <meta name="twitter:description" content="An intentionally insecure system is insecure. As Raymond Chen says, &quot;You can&#39;t make up for
the absence of any actual vulnerability by piling on style points and cranking
up the degree of difficulty.&quot;"/>
  
  <meta name="twitter:domain" content="parsiya.net"/>
  <meta name="twitter:creator" content="@CryptoGangsta"/>

  

  
  



</head>
<body>


<header role="banner">
<hgroup>
  
  <h1><a href="http://localhost:1313/">அஃக</a></h1>
    <h2>தமிழின் பெரிய சொற்தொகுப்பு</h2>
</hgroup></header>


<nav role="navigation">
<fieldset class="mobile-nav">
  
  <select onchange="location = this.value;">
    <option value="">Navigate…</option>
      
        <option value="http://localhost:1313/about/">» About Me!</option>
      
        <option value="http://localhost:1313/letters/">» எழுத்து</option>
      
  </select>
</fieldset>


<ul class="main-navigation">
  
  
    
      <li><a href="http://localhost:1313/about/" title="About Me!"  target="_blank"  rel="noopener noreferrer">About Me!</a></li>
    
  
    
      <li><a href="http://localhost:1313/letters/" title="எழுத்து"  target="_blank"  rel="noopener noreferrer">எழுத்து</a></li>
    
  
</ul>

<ul class="subscription">
  
    
        <a href="http://localhost:1313/index.xml" target="_blank" type="application/rss+xml" title="RSS" rel="noopener noreferrer"><i class="fa fa-rss-square fa-lg"></i></a>
    
  
</ul>


  <form action="https://www.google.com/search" method="get" target="_blank" rel="noopener noreferrer">
    <fieldset role="search">
      <input class="search" type="text" name="q" results="0" placeholder="Search"/>
      <input type="hidden" name="q" value="site:http://localhost:1313/" />
    </fieldset>
  </form>

</nav>


<div id="main">
  <div id="content">
    <div>
      <article class="hentry" role="article">

        
        

<header>
  <p class="meta">Jul 25, 2020
     - 7 minute read 
     - <a href="http://localhost:1313/blog/2020-07-25-no-you-are-not-getting-a-cve-for-that/#disqus_thread">Comments</a>

    
    
      - <a class="label" href="http://localhost:1313/categories/soapbox/">soapbox </a>
    
  </p>
  <h1 class="entry-title">
     No, You Are Not Getting a CVE for That 
  </h1>
</header>


        <div class="entry-content">
          
          
          
          <p>An intentionally insecure system is insecure. As <a href="https://devblogs.microsoft.com/oldnewthing/?p=18593" rel="nofollow" target="_blank">Raymond Chen says</a>, &quot;You can't make up for
the absence of any actual vulnerability by piling on style points and cranking
up the degree of difficulty.&quot;</p>

<p>Every once in a while I see a vulnerability write-up or disclosure report that
makes me scream internally and not in a good way. Usually, I try to be polite
and act professional. Professional means I will send you this blog post by
Raymond Chen:</p>

<ul>
<li><a href="https://devblogs.microsoft.com/oldnewthing/20060508-22/?p=31283" rel="nofollow" target="_blank">It rather involved being on the other side of this airtight hatchway</a>.</li>
</ul>

<p>The title is from the book <a href="https://en.wikipedia.org/wiki/The_Hitchhiker%27s_Guide_to_the_Galaxy" rel="nofollow" target="_blank">The Hitchhiker's Guide to the Galaxy</a>
by one of my favorite authors Douglas Adams.</p>












  
  
  
  





  


<blockquote>
  <p>Arthur: But can't you think of something?!<br />
Ford: I did.<br />
Arthur: You did!<br />
Ford: Unfortunately, it rather involved being on the other side of this airtight hatchway—<br />
Arthur: oh.<br />
Ford: —that's just sealed behind us.</p>
  <footer>
    <strong>Douglas Adams</strong>
    
      <cite>Hitchhiker&#39;s Guide to the Galaxy - Fit The Second</cite>
    
  </footer>
</blockquote>

<p>You can find a plethora of these on <a href="https://devblogs.microsoft.com/oldnewthing/?s=airtight+hatchway&amp;submit=%EE%9C%A1" rel="nofollow" target="_blank">Raymond's blog</a>.</p>

<p>These vulnerabilities have one thing in common. In order to exploit them you
need to already be part of the user group that can do that thing. Commonly, you
need to be admin to do admin things. You just need to be on the other side of
the airtight hatchway, first.</p>






<span class="caption-wrapper">
  <img class="caption" src="01-goodnews.png" title="Good news, everyone!" alt="Good news, everyone!">
  <span class="caption-text">Good news, everyone!</span>
</span>


<p>Before we continue, let's talk about privilege levels.</p>

<h1 id="privilege-levels-in-a-typical-windows-machine">Privilege Levels in a Typical Windows Machine</h1>

<p>From low to high we have:</p>

<p><code>Remote attacker &lt; Local standard user &lt; Local admin/SYSTEM</code><sup class="footnote-ref" id="fnref:1"><a href="#fn:1">1</a></sup>.</p>












  
  
  
  





      
      
      
    
     
      
    
    

    
    
         
         
         

         
        
        
      
      
    
  


<blockquote>
  <p>Code injection doesn't become a security hole until you have elevation of privilege.</p>
  <footer>
    <strong>Raymond Chen</strong>
    
      
        <cite>
          <a href="https://devblogs.microsoft.com/oldnewthing/20060508-22/?p=31283" title="https://devblogs.microsoft.com/oldnewthing/20060508-22/?p=31283">devblogs.microsoft.com/...</a> 
        </cite>
      
    
  </footer>
</blockquote>

<p>The following are not issues:</p>

<ol>
<li>A user can inject code into their own process.</li>
<li>A user can inject code into a less-privileged process.</li>
</ol>

<p>But, this is an issue:</p>

<ol>
<li>A less-privileged user can inject code into a more-privileged process.</li>
</ol>

<p>This could be a remote attacker running code on the machine or Remote Code
Execution (RCE).</p>












  
  
  
  





      
      
      
    
     
      
    
    

    
    
         
         
         

         
        
        
      
      
    
  


<blockquote>
  <p>If some hacker on the Internet can inject code onto your computer, then they
have successfully elevated their privileges, because that hacker didn't have
the ability to execute arbitrary code on your machine prior to the exploit.</p>
  <footer>
    <strong>Raymond Chen</strong>
    
      
        <cite>
          <a href="https://devblogs.microsoft.com/oldnewthing/20060508-22/?p=31283" title="https://devblogs.microsoft.com/oldnewthing/20060508-22/?p=31283">devblogs.microsoft.com/...</a> 
        </cite>
      
    
  </footer>
</blockquote>

<p>Or a standard user running code as admin/SYSTEM. This is called &quot;Local Privilege
Escalation.&quot;</p>

<h1 id="non-issues">Non-issues</h1>

<p>Here's some common non-issues that are hyped with style points.</p>

<p>Style points are fancy ways of doing something common. In the context of this
blog style points are all the extra steps to get code execution on a machine
when you already have code execution on a machine at that privilege level.</p>












  
  
  
  





      
      
      
    
     
      
    
    

    
    
         
         
         

         
        
        
      
      
    
  


<blockquote>
  <p>You just found a complicated way of doing something perfectly mundane. You can't
make up for the absence of any actual vulnerability by piling on style points
and cranking up the degree of difficulty.</p>
  <footer>
    <strong>Raymond Chen</strong>
    
      
        <cite>
          <a href="https://devblogs.microsoft.com/oldnewthing/?p=18593" title="https://devblogs.microsoft.com/oldnewthing/?p=18593">devblogs.microsoft.com/...</a> 
        </cite>
      
    
  </footer>
</blockquote>

<h2 id="unquoted-service-paths">Unquoted Service Paths</h2>

<p>Reading assignment:</p>

<ul>
<li><a href="https://docs.microsoft.com/en-us/archive/blogs/aaron_margosis/it-rather-involved-being-on-the-other-side-of-this-airtight-hatchway-unquoted-service-paths" rel="nofollow" target="_blank">https://docs.microsoft.com/en-us/archive/blogs/aaron_margosis/it-rather-involved-being-on-the-other-side-of-this-airtight-hatchway-unquoted-service-paths</a></li>
</ul>

<p><strong>Unquoted Service Paths are almost never exploitable.</strong> Standard users do not
have access to create files in the root of the <code>C</code> drive. This means you cannot
make <code>C:\program.exe</code>. Standard users have no write access inside <code>C:\Program
Files</code> or the 32-bit counterpart, either.</p>

<p>But what if you installed it on a flash drive and with no access restrictions?
Well, don't. The user could install the app in a location and then change the
ACLs. It's a minor issue and you are not getting a CVE for that.</p>












  
  
  
  





      
      
      
    
     
      
    
    

    
    
         
         
         

         
        
        
        
        
      
      
    
  


<blockquote>
  <p>'unquoted service path' is the clickjacking of thickclient vulnerabilities.</p>
  <footer>
    <strong>Parsia</strong>
    
      
        <cite>
          <a href="https://twitter.com/CryptoGangsta/status/1279242524100407297" title="https://twitter.com/CryptoGangsta/status/1279242524100407297">twitter.com/CryptoGangsta/...</a> 
        </cite>
      
    
  </footer>
</blockquote>

<p>Yes, I just quoted myself, lol.</p>

<p><strong>Update 2021-06-03:</strong> I was proven wrong. Someone actually <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-15261" rel="nofollow" target="_blank">got a CVE for
that</a>. Not dissing the finder, but this is not a vulnerability.</p>

<blockquote>
<p>On Windows the Veyon Service contains an unquoted service path vulnerability,
allowing locally authenticated users with administrative privileges to run
malicious executables with LocalSystem privileges.</p>
</blockquote>

<p>Local admin to SYSTEM is intended.</p>

<h2 id="dll-hijacking">DLL Hijacking</h2>

<p>Reading assignment:</p>

<ul>
<li><a href="https://itm4n.github.io/windows-dll-hijacking-clarified/" rel="nofollow" target="_blank">https://itm4n.github.io/windows-dll-hijacking-clarified/</a></li>
</ul>

<p>In simple words means the OS will search for a missing DLL in certain paths. You
might be able to plant your own malicious DLL in one of those and get code
execution.</p>

<p>A <a href="https://www.bing.com/search?q=%22C%3A%5Cpython27%22+DLL+hijacking" rel="nofollow" target="_blank">good chunk of DLL Hijacking CVEs</a> happen when there's a DLL
missing and people use <code>C:\python27</code> to plant their DLL. Well, no shit. I bet
the overwhelming majority of Windows users do not have that directory, I don't
and I am a power user. I don't have Python on my host OS.</p>

<p><strong>Always test in a clean install.</strong> If you have to intentionally weaken the OS
then it's not a security issue.</p>












  
  
  
  





      
      
      
    
     
      
    
    

    
    
         
         
         

         
        
        
      
      
    
  


<blockquote>
  <p>An insecure system is insecure.</p>
  <footer>
    <strong>Raymond Chen</strong>
    
      
        <cite>
          <a href="https://devblogs.microsoft.com/oldnewthing/20180227-00/?p=98115" title="https://devblogs.microsoft.com/oldnewthing/20180227-00/?p=98115">devblogs.microsoft.com/...</a> 
        </cite>
      
    
  </footer>
</blockquote>

<h3 id="the-local-file">The .Local File</h3>

<p>The <code>.local</code> file can be used to <a href="https://docs.microsoft.com/en-us/windows/win32/dlls/dynamic-link-library-redirection" rel="nofollow" target="_blank">mitigate DLL hell</a>. If you have
<code>whatever.exe.local</code> then <code>whatever.exe</code> will look in the current directory for
DLLs first and then somewhere else.</p>

<p>A common explanation is putting the <code>.local</code> file by the executable. If you have
write access to that directory? <strong>Why can't you just edit the executable?</strong></p>

<p><code>.local</code> files also come up in the context of installers:</p>

<ol>
<li>Make users download the <code>.local</code> file and a malicious DLL.

<ol>
<li>These get stored in the downloads directory.</li>
</ol></li>
<li>Users download the installer for an application.</li>
<li>When the user starts the installer it will load your DLL and run your code.</li>
</ol>

<p>Why do all of this when you can:</p>

<ol>
<li>Make users download a malicious installer.</li>
<li>When they run it, your code is executed.</li>
</ol>

<h2 id="overwriting-admin-only-writable-item">Overwriting Admin Only Writable Item</h2>

<p>This was covered briefly in the DLL hijacking section. If you can modify a
binary that is executed or loaded as SYSTEM then you can be SYSTEM. But if only
admins can modify it then you have accomplished nothing.</p>

<p>Here's a blog by Raymond where he talks about a reported issue. Planting DLLs
in <code>System32</code> to get DLL hijacking can only be done by admins. So, no CVE.</p>

<ul>
<li><a href="https://devblogs.microsoft.com/oldnewthing/20131023-00/?p=2853" rel="nofollow" target="_blank">https://devblogs.microsoft.com/oldnewthing/20131023-00/?p=2853</a></li>
</ul>

<p>Note: This is completely different if you manage to exploit a (usually logical)
bug where you can trick a higher privileged process into overwriting a file
there. This usually happens with symlink and Windows services.</p>

<h2 id="content-injection-on-404-pages">Content Injection on 404 Pages</h2>

<p>This is a web application thing. 404 pages are usually very bland. Sometimes
they include the missing page. Something along the lines of:</p>

<blockquote>
<p>Page X could not be found. Please contact the site administrator.</p>
</blockquote>

<p>There are a few web servers with 404 templates that do this. I have seen a ton
of reports where the proof of concept has been:</p>

<ol>
<li>Navigate to <code>whatever.com/[bunch of spaces here]website not found, go to evil.com</code>.</li>
<li>Observe the injected content.</li>
</ol>

<p>Usually the spaces are ignored and it looks like.</p>

<blockquote>
<p>Page website not found, go to evil.com could not be found. Please contact the site administrator.</p>
</blockquote>

<p>This is not a security issue. The <code>evil.com</code> is almost never a link. This means
the user has to manually enter <code>evil.com</code> in their browser. In other words, it's
much easier to create a link to <code>evil.com</code> with the caption <code>example.net</code> and
spray internet forums with it.</p>

<p>Google specifically excludes this:</p>

<ul>
<li><a href="https://sites.google.com/site/bughunteruniversity/nonvuln/limited-content-reflection-or-content-spoofing" rel="nofollow" target="_blank">https://sites.google.com/site/bughunteruniversity/nonvuln/limited-content-reflection-or-content-spoofing</a></li>
</ul>

<h2 id="adding-account-takeover-to-the-end-of-vulnerability-title">Adding &quot;Account Takeover&quot; to the End of Vulnerability Title</h2>

<p>I have read reports with <code>Clickjacking to Account Takeover</code> where the only thing
in the report was the OWASP test page. It only shows that you can load the page
in an iframe. Clickjacking without a proof of concept is not an issue. What can
you do with it?</p>

<p>I blame bugbounty influencers for this. There are entire guides on how to hype
up your bug to get better payouts. I am all for people making money. Hell, <strong>I
encourage you to milk the companies as much as you can while the fad
continues.</strong> But, please do not try to trick me or other security engineers.</p>

<h1 id="what-did-we-learn-here-today">What Did We Learn Here Today?</h1>

<ol>
<li>Only report actual security issues.</li>
<li>Adding extra style points does not work.</li>
<li>CVE is a shitty way of measuring your success.</li>
<li>We both know what we are doing, please don't try to trick me. I am on your
side.</li>
</ol>
<div class="footnotes">

<hr />

<ol>
<li id="fn:1">Local admin to/from <code>NT Authority/SYSTEM</code> is intended and not a security issue.
 <a class="footnote-return" href="#fnref:1"><sup>[return]</sup></a></li>
</ol>
</div>
        </div>
        

<footer>
  <p class="meta">
    <span class="byline author vcard">Posted by <span class="fn">Parsia</span></span>
    
    <time>Jul 25, 2020</time>
    
    </span>
  </p>

  

  <p class="meta">
    
        <a class="basic-alignment left" href="http://localhost:1313/blog/2020-06-22-thick-client-proxying-part-11-gog-galaxy-and-extract-sni/" title="Thick Client Proxying - Part 11 - GOG Galaxy and Extract-SNI">Thick Client Proxying - Part 11 - GOG Galaxy and Extract-SNI</a>
    

    
      <a class="basic-alignment right" href="http://localhost:1313/blog/2020-08-13-localghost-escaping-the-browser-sandbox-without-0-days/" title="localghost: Escaping the Browser Sandbox Without 0-Days">localghost: Escaping the Browser Sandbox Without 0-Days</a>
    
  </p>
  
    
      <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "parsiya" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    
  
</footer>

      </article>
    </div>
    

<aside class="sidebar thirds">
  <section class="first odd">

    
      <h1>Who am I?</h1>
    

    <p>
      
        <p>I am Pitchaimuthu Muthaiya, a senior security engineer.</p>

<p>I write about application tamil words and roots of words.</p>

<p>Click on <a href="/about/">About Me!</a> to know more.</p>

      
    </p>
  </section>



  
  <ul class="sidebar-nav">
    <li class="sidebar-nav-item">
      <a target="_blank" rel="noopener noreferrer" href="https://github.com/parsiya/" title="https://github.com/parsiya/"><i class="fa fa-github fa-3x"></i></a>
      
      
      <a target="_blank" rel="noopener noreferrer" href="https://twitter.com/cryptogangsta/" title="https://twitter.com/cryptogangsta/"><i class="fa fa-twitter fa-3x"></i></a>
      
        <a target="_blank" rel="noopener noreferrer" href="https://keybase.io/parsiya/" title="https://keybase.io/parsiya/"><i class="fa fa-keybase fa-3x"></i></a> 
      
      <a target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/in/parsiya" title="https://www.linkedin.com/in/parsiya"><i class="fa fa-linkedin fa-3x"></i></a>
      
      
      
      
      

    
    
    </li>
  </ul>

  

  
    
      <section class="odd">
        
          <h1>Collections</h1>
        
        
          <li>
            <a href="http://localhost:1313/categories/thick-client-proxying/" title="Thick Client Proxying" >Thick Client Proxying</a>
          </li>
        
          <li>
            <a href="http://localhost:1313/categories/writeup/" title="CTFs/Writeups" >CTFs/Writeups</a>
          </li>
        
          <li>
            <a href="http://localhost:1313/categories/attack-surface-analysis/" title="Attack Surface Analysis" >Attack Surface Analysis</a>
          </li>
        
          <li>
            <a href="http://localhost:1313/categories/bug-bounty/" title="Bug Bounty" >Bug Bounty</a>
          </li>
        
          <li>
            <a href="http://localhost:1313/categories/go/" title="Go/Golang" >Go/Golang</a>
          </li>
        
          <li>
            <a href="http://localhost:1313/categories/blockchain/" title="Blockchain" >Blockchain</a>
          </li>
        
          <li>
            <a href="http://localhost:1313/categories/burp-extension/" title="Burp Extension Development" >Burp Extension Development</a>
          </li>
        
          <li>
            <a href="http://localhost:1313/categories/automation/" title="Automation" >Automation</a>
          </li>
        
          <li>
            <a href="http://localhost:1313/categories/reverse-engineering/" title="Reverse Engineering" >Reverse Engineering</a>
          </li>
        
          <li>
            <a href="http://localhost:1313/categories/crypto/" title="Crypto(graphy)" >Crypto(graphy)</a>
          </li>
        
          <li>
            <a href="http://localhost:1313/categories/winappdbg/" title="WinAppDbg" >WinAppDbg</a>
          </li>
        
          <li>
            <a href="https://awsome.pw" title="AWSome.pw - S3 bucket squatting - my very legit branded vulnerability" >AWSome.pw - S3 bucket squatting - my very legit branded vulnerability</a>
          </li>
        
      </section>
    
  

  
  
  
</aside>

  </div>
</div>

    <footer role="contentinfo">
      <p>Copyright &copy; 2021 Parsia - <a href="http://localhost:1313/license/">License</a> -
        <span class="credit">Powered by <a target="_blank" href="https://gohugo.io" rel="noopener noreferrer">Hugo</a> and <a target="_blank" href="https://github.com/parsiya/hugo-octopress/" rel="noopener noreferrer">Hugo-Octopress</a> theme.
      </p>
    </footer>

    
    



    
    
    

    
  </body>
</html>

