<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width,minimum-scale=1,maximum-scale=1">

  
    
    
      <link href="/css/fonts.css" rel="stylesheet" type="text/css">
    
  

  
  <title>On Username Enumeration</title>

  
  
  <link rel="stylesheet" href="/css/hugo-octopress.css">

  
  

  
    <link rel="stylesheet" href="/css/fork-awesome.min.css">
  

  
  <link href="http://localhost:1313/favicon.png" rel="icon">

  
  

  <meta name="description" content="" />
  <meta name="keywords" content="[Parsia Hakimian Parsiya infosec information security]">
  <meta name="author" content="Parsia">

  
  <meta name="generator" content="Hugo 0.83.1" />

  
  

  
  
    

  
  
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:image:src" content="http://localhost:1313/blog/2018-05-26-on-username-enumeration/01-invalid-username.png"/>
  
  
  <meta name="twitter:title" content="On Username Enumeration"/>
  <meta name="twitter:description" content="Enumeration is identifying valid resources in a target address space. This sounds academic and I hate academic mumbo jumbo but bear with me.

Username enumeration is identifying valid user identifiers in an application. These are typically usernames or account IDs.

Enumeration is an interesting topic. The concept of enumeration is straightforward but not always obvious. In this post I will explain username enumeration using an example."/>
  
  <meta name="twitter:domain" content="parsiya.net"/>
  <meta name="twitter:creator" content="@CryptoGangsta"/>

  

  
  



</head>
<body>


<header role="banner">
<hgroup>
  
  <h1><a href="http://localhost:1313/">அஃக</a></h1>
    <h2>தமிழின் பெரிய சொற்தொகுப்பு</h2>
</hgroup></header>


<nav role="navigation">
<fieldset class="mobile-nav">
  
  <select onchange="location = this.value;">
    <option value="">Navigate…</option>
      
        <option value="http://localhost:1313/about/">» About Me!</option>
      
        <option value="http://localhost:1313/letters/">» எழுத்து</option>
      
  </select>
</fieldset>


<ul class="main-navigation">
  
  
    
      <li><a href="http://localhost:1313/about/" title="About Me!"  target="_blank"  rel="noopener noreferrer">About Me!</a></li>
    
  
    
      <li><a href="http://localhost:1313/letters/" title="எழுத்து"  target="_blank"  rel="noopener noreferrer">எழுத்து</a></li>
    
  
</ul>

<ul class="subscription">
  
    
        <a href="http://localhost:1313/index.xml" target="_blank" type="application/rss+xml" title="RSS" rel="noopener noreferrer"><i class="fa fa-rss-square fa-lg"></i></a>
    
  
</ul>


  <form action="https://www.google.com/search" method="get" target="_blank" rel="noopener noreferrer">
    <fieldset role="search">
      <input class="search" type="text" name="q" results="0" placeholder="Search"/>
      <input type="hidden" name="q" value="site:http://localhost:1313/" />
    </fieldset>
  </form>

</nav>


<div id="main">
  <div id="content">
    <div>
      <article class="hentry" role="article">

        
        

<header>
  <p class="meta">May 26, 2018
     - 4 minute read 
     - <a href="http://localhost:1313/blog/2018-05-26-on-username-enumeration/#disqus_thread">Comments</a>

    
    
      - <a class="label" href="http://localhost:1313/categories/enumeration/">Enumeration </a>
    
  </p>
  <h1 class="entry-title">
     On Username Enumeration 
  </h1>
</header>


        <div class="entry-content">
          
          
          
          <p>Enumeration is <em>identifying valid resources in a target address space</em>. This sounds academic and I hate academic mumbo jumbo but bear with me.</p>

<p>Username enumeration is <em>identifying valid user identifiers in an application</em>. These are typically usernames or account IDs.</p>

<p>Enumeration is an interesting topic. The concept of enumeration is straightforward but not always obvious. In this post I will explain username enumeration using an example.</p>

<h1 id="login-requests-and-username-enumeration">Login Requests and Username Enumeration</h1>

<p>One of the easiest places to check for username enumeration (and one of the first things I check) is the login request.</p>

<p>Send two unsuccessful login requests, one with a valid username (and invalid password because we do not want to login) and the other with an invalid one. <strong>Compare the responses and see if you can spot a difference</strong>. It there is a difference then you got username enumeration.</p>

<p>Sometimes it's part of the business logic. For example, Google or Amazon don't care about username enumeration. You enter your username and if valid, you are redirected to password page.</p>

<p>Sometimes the difference in the response message is pretty obvious. Something like &quot;this username does not exist.&quot; Often times it's a bit more subtle and there's some numeric error code that gives it away.</p>

<h1 id="the-curious-example">The Curious Example</h1>

<p>In this application, usernames are emails. This is pretty typical in most web application.</p>

<p>First I sent a login request with an invalid username. Here's the response displayed in Burp's Repeater tab.</p>






<span class="caption-wrapper">
  <img class="caption" src="01-invalid-username.png" title="Response to login with invalid username" alt="Response to login with invalid username">
  <span class="caption-text">Response to login with invalid username</span>
</span>


<p>Then sent a request with a valid username and got a response.</p>






<span class="caption-wrapper">
  <img class="caption" src="02-valid-username.png" title="Response to login with valid username" alt="Response to login with valid username">
  <span class="caption-text">Response to login with valid username</span>
</span>


<p>This two look very similar. To easily spot differences, I used Burp's <code>Comparer</code>. Right click on each, <code>Send to Comparer</code> and we can compare <code>by words</code> there.</p>






<span class="caption-wrapper">
  <img class="caption" src="03-comparer.png" title="Comparing two responses" alt="Comparing two responses">
  <span class="caption-text">Comparing two responses</span>
</span>


<p>Well they are pretty much the same. The <code>Request-Context</code> is redacted from the image but the value is the same for both responses.</p>

<p>There is username enumeration there, it's not just as visible as it is. But don't worry, this is not some complex math. You will be able to spot it after it's pointed out forever.</p>

<h2 id="side-channel-attacks">Side-Channel Attacks</h2>

<p>Side-channels are, well side-channels. These are channels from which the system can leak information. The most popular side-channel is time. This results in timing attacks.</p>

<p>Apart from the request/response, Burp shows us the response time. Unfortunately, this does not show up in <code>Comparer</code>. Let's put those initial responses together and look at the response times again.</p>






<span class="caption-wrapper">
  <img class="caption" src="04-time.png" title="Response difference highlighted" alt="Response difference highlighted">
  <span class="caption-text">Response difference highlighted</span>
</span>


<p>Login with valid username takes around 250ms while invalid usernames take 10x more around 2.5s. This can be effectively used to weed out valid/invalid usernames/emails.</p>

<h1 id="appendix-some-tips-and-tricks">Appendix: Some Tips and Tricks</h1>

<p>I have seen some timing attacks. I have read about others. This section shares what I have learned.</p>

<h2 id="reducing-the-address-space">Reducing the Address Space</h2>

<p><strong>Know your address space.</strong> Research the address space of the what you are trying to attack. If the application uses emails, random strings do not work. Emails have specific formats. Same can be said about other structured data. Credit cards are 16 digits and the first six digits are predictable based on the issuer. Last digit is the <code>check digit</code> based on the <a href="https://en.wikipedia.org/wiki/Luhn_algorithm" rel="nofollow" target="_blank">Lunh Algorithm</a>.</p>

<p>Like fuzzing, you don't want to pass invalid data. You want to bruteforce intelligently.</p>

<h2 id="bruteforcing">Bruteforcing</h2>

<p>Side-channel attacks and bruteforcing are very closely connected. Usually a side-channel attack allows you to bruteforce something. In this case, we are bruteforcing email addresses. Reducing the address space allows us to bruteforce much better.</p>

<p>Let's assume we want to bruteforce a number. If our number is an <code>int</code>, we have a much easier time compared to <code>float</code>s. Theoretically the number of <em>Natural Numbers</em> is infinity and the number of floats between two ints is the same. In action, you can only implement so many decimal and floating points. The total number of ints is lower than total number of floats.</p>

<h1 id="conclusion">Conclusion</h1>

<p><strong>LOOK AT THE RESPONSE TIME.</strong></p>

<!-- Links -->
        </div>
        

<footer>
  <p class="meta">
    <span class="byline author vcard">Posted by <span class="fn">Parsia</span></span>
    
    <time>May 26, 2018</time>
    
      <span class="categories">
        Tags:
        
          <a class="category" href="http://localhost:1313/tags/tags2">tags2</a>  
    
    </span>
  </p>

  

  <p class="meta">
    
        <a class="basic-alignment left" href="http://localhost:1313/blog/2018-05-05-learning-go-fuzz-2-goexif2/" title="Learning Go-Fuzz 2: goexif2">Learning Go-Fuzz 2: goexif2</a>
    

    
      <a class="basic-alignment right" href="http://localhost:1313/blog/2018-06-05-contextis-xmas-ctf-writeup/" title="ContextIS xmas CTF Writeup">ContextIS xmas CTF Writeup</a>
    
  </p>
  
    
      <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "parsiya" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    
  
</footer>

      </article>
    </div>
    

<aside class="sidebar thirds">
  <section class="first odd">

    
      <h1>Who am I?</h1>
    

    <p>
      
        <p>I am Pitchaimuthu Muthaiya, a senior security engineer.</p>

<p>I write about application tamil words and roots of words.</p>

<p>Click on <a href="/about/">About Me!</a> to know more.</p>

      
    </p>
  </section>



  
  <ul class="sidebar-nav">
    <li class="sidebar-nav-item">
      <a target="_blank" rel="noopener noreferrer" href="https://github.com/parsiya/" title="https://github.com/parsiya/"><i class="fa fa-github fa-3x"></i></a>
      
      
      <a target="_blank" rel="noopener noreferrer" href="https://twitter.com/cryptogangsta/" title="https://twitter.com/cryptogangsta/"><i class="fa fa-twitter fa-3x"></i></a>
      
        <a target="_blank" rel="noopener noreferrer" href="https://keybase.io/parsiya/" title="https://keybase.io/parsiya/"><i class="fa fa-keybase fa-3x"></i></a> 
      
      <a target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/in/parsiya" title="https://www.linkedin.com/in/parsiya"><i class="fa fa-linkedin fa-3x"></i></a>
      
      
      
      
      

    
    
    </li>
  </ul>

  

  
    
      <section class="odd">
        
          <h1>Collections</h1>
        
        
          <li>
            <a href="http://localhost:1313/categories/thick-client-proxying/" title="Thick Client Proxying" >Thick Client Proxying</a>
          </li>
        
          <li>
            <a href="http://localhost:1313/categories/writeup/" title="CTFs/Writeups" >CTFs/Writeups</a>
          </li>
        
          <li>
            <a href="http://localhost:1313/categories/attack-surface-analysis/" title="Attack Surface Analysis" >Attack Surface Analysis</a>
          </li>
        
          <li>
            <a href="http://localhost:1313/categories/bug-bounty/" title="Bug Bounty" >Bug Bounty</a>
          </li>
        
          <li>
            <a href="http://localhost:1313/categories/go/" title="Go/Golang" >Go/Golang</a>
          </li>
        
          <li>
            <a href="http://localhost:1313/categories/blockchain/" title="Blockchain" >Blockchain</a>
          </li>
        
          <li>
            <a href="http://localhost:1313/categories/burp-extension/" title="Burp Extension Development" >Burp Extension Development</a>
          </li>
        
          <li>
            <a href="http://localhost:1313/categories/automation/" title="Automation" >Automation</a>
          </li>
        
          <li>
            <a href="http://localhost:1313/categories/reverse-engineering/" title="Reverse Engineering" >Reverse Engineering</a>
          </li>
        
          <li>
            <a href="http://localhost:1313/categories/crypto/" title="Crypto(graphy)" >Crypto(graphy)</a>
          </li>
        
          <li>
            <a href="http://localhost:1313/categories/winappdbg/" title="WinAppDbg" >WinAppDbg</a>
          </li>
        
          <li>
            <a href="https://awsome.pw" title="AWSome.pw - S3 bucket squatting - my very legit branded vulnerability" >AWSome.pw - S3 bucket squatting - my very legit branded vulnerability</a>
          </li>
        
      </section>
    
  

  
  
  
</aside>

  </div>
</div>

    <footer role="contentinfo">
      <p>Copyright &copy; 2021 Parsia - <a href="http://localhost:1313/license/">License</a> -
        <span class="credit">Powered by <a target="_blank" href="https://gohugo.io" rel="noopener noreferrer">Hugo</a> and <a target="_blank" href="https://github.com/parsiya/hugo-octopress/" rel="noopener noreferrer">Hugo-Octopress</a> theme.
      </p>
    </footer>

    
    



    
    
    

    
  </body>
</html>

