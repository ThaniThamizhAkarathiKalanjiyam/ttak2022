<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width,minimum-scale=1,maximum-scale=1">

  
    
    
      <link href="/css/fonts.css" rel="stylesheet" type="text/css">
    
  

  
  <title>DVTA - Part 5 - Client-side Storage and DLL Hijacking</title>

  
  
  <link rel="stylesheet" href="/css/hugo-octopress.css">

  
  

  
    <link rel="stylesheet" href="/css/fork-awesome.min.css">
  

  
  <link href="http://localhost:1313/favicon.png" rel="icon">

  
  

  <meta name="description" content="" />
  <meta name="keywords" content="[Parsia Hakimian Parsiya infosec information security]">
  <meta name="author" content="Parsia">

  
  <meta name="generator" content="Hugo 0.83.1" />

  
  

  
  
    

  
  
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:image:src" content="http://localhost:1313/blog/2018-08-25-dvta-part-5-client-side-storage-and-dll-hijacking/img/15.png"/>
  
  
  <meta name="twitter:title" content="DVTA - Part 5 - Client-side Storage and DLL Hijacking"/>
  <meta name="twitter:description" content="Thick clients store ample information on the device. In this part, we are going to investigate DVTA to see what, how, and where it stores data. We are also going to do some basic DLL hijacking. Our tools are procmon, PowerSploit, and dnSpy.

Previous parts are at:


DVTA - Part 1 - Setup
DVTA - Part 2 - Cert Pinning and Login Button
DVTA - Part 3 - Network Recon
DVTA - Part 4 - Traffic Tampering with dnSpy
"/>
  
  <meta name="twitter:domain" content="parsiya.net"/>
  <meta name="twitter:creator" content="@CryptoGangsta"/>

  

  
  



</head>
<body>


<header role="banner">
<hgroup>
  
  <h1><a href="http://localhost:1313/">அஃக</a></h1>
    <h2>தமிழின் பெரிய சொற்தொகுப்பு</h2>
</hgroup></header>


<nav role="navigation">
<fieldset class="mobile-nav">
  
  <select onchange="location = this.value;">
    <option value="">Navigate…</option>
      
        <option value="http://localhost:1313/about/">» About Me!</option>
      
        <option value="http://localhost:1313/letters/">» எழுத்து</option>
      
  </select>
</fieldset>


<ul class="main-navigation">
  
  
    
      <li><a href="http://localhost:1313/about/" title="About Me!"  target="_blank"  rel="noopener noreferrer">About Me!</a></li>
    
  
    
      <li><a href="http://localhost:1313/letters/" title="எழுத்து"  target="_blank"  rel="noopener noreferrer">எழுத்து</a></li>
    
  
</ul>

<ul class="subscription">
  
    
        <a href="http://localhost:1313/index.xml" target="_blank" type="application/rss+xml" title="RSS" rel="noopener noreferrer"><i class="fa fa-rss-square fa-lg"></i></a>
    
  
</ul>


  <form action="https://www.google.com/search" method="get" target="_blank" rel="noopener noreferrer">
    <fieldset role="search">
      <input class="search" type="text" name="q" results="0" placeholder="Search"/>
      <input type="hidden" name="q" value="site:http://localhost:1313/" />
    </fieldset>
  </form>

</nav>


<div id="main">
  <div id="content">
    <div>
      <article class="hentry" role="article">

        
        

<header>
  <p class="meta">Aug 25, 2018
     - 7 minute read 
     - <a href="http://localhost:1313/blog/2018-08-25-dvta-part-5-client-side-storage-and-dll-hijacking/#disqus_thread">Comments</a>

    
    
      - <a class="label" href="http://localhost:1313/categories/reverse-engineering/">Reverse Engineering </a><a class="label" href="http://localhost:1313/categories/dvta/">DVTA </a><a class="label" href="http://localhost:1313/categories/writeup/">Writeup </a>
    
  </p>
  <h1 class="entry-title">
     DVTA - Part 5 - Client-side Storage and DLL Hijacking 
  </h1>
</header>


        <div class="entry-content">
          
          
          
          <p>Thick clients store ample information on the device. In this part, we are going to investigate DVTA to see what, how, and where it stores data. We are also going to do some basic DLL hijacking. Our tools are procmon, PowerSploit, and dnSpy.</p>

<p>Previous parts are at:</p>

<ul>
<li><a href="/blog/2018-07-15-dvta-part-1-setup/" title="DVTA - Part 1 - Setup" rel="nofollow" target="_blank">DVTA - Part 1 - Setup</a></li>
<li><a href="/blog/2018-07-21-dvta-part-2-cert-pinning-and-login-button/" title="DVTA - Part 2 - Cert Pinning and Login Button" rel="nofollow" target="_blank">DVTA - Part 2 - Cert Pinning and Login Button</a></li>
<li><a href="/blog/2018-07-30-dvta-part-3-network-recon/" title="DVTA - Part 3 - Network Recon" rel="nofollow" target="_blank">DVTA - Part 3 - Network Recon</a></li>
<li><a href="/blog/2018-08-02-dvta-part-4-traffic-tampering-with-dnspy/" title="DVTA - Part 4 - Traffic Tampering with dnSpy" rel="nofollow" target="_blank">DVTA - Part 4 - Traffic Tampering with dnSpy</a></li>
</ul>

<h1 id="grabbing-database-credentials-via-static-analysis">Grabbing Database Credentials via Static Analysis</h1>

<p>In <a href="/blog/2018-08-02-dvta-part-4-traffic-tampering-with-dnspy/#grabbing-the-database-credentials" title="Part 4 - Grabbing the Database Credentials" rel="nofollow" target="_blank">Part 4</a> we discovered the MSSQL credentials through dynamic analysis with dnSpy. The credentials are <code>admin:p@ssw0rd</code>. This time we are going to see where they are stored and how.</p>

<p>Open up dnSpy and load the application. Search for the <code>RegisterUser</code> method (if the search is not successful manually drag and drop <code>DBAccess.dll</code>). Right-click on the <code>RegisterUser</code> method and select <code>Analyze</code>. Note we are not in the main application anymore but inside <code>DBAccess.dll</code>. Under <code>Used By</code> we can see <code>btnReg_Click</code>.</p>






<span class="caption-wrapper">
  <img class="caption" src="img/01.png" title="Tracing RegisterUser" alt="Tracing RegisterUser">
  <span class="caption-text">Tracing RegisterUser</span>
</span>


<p>Inside <code>btnReg_Click</code> the connection is being created:</p>






<span class="caption-wrapper">
  <img class="caption" src="img/02.png" title="Inside btnReg_Click" alt="Inside btnReg_Click">
  <span class="caption-text">Inside btnReg_Click</span>
</span>


<p>Double-clicking on <code>openConnection</code> takes us to the method that establishes the connection.</p>






<span class="caption-wrapper">
  <img class="caption" src="img/03.png" title="openConnection method" alt="openConnection method">
  <span class="caption-text">openConnection method</span>
</span>


<p>The application is reading some information from <code>ConfigurationManager.AppSettings</code>. This information comes from the <code>AppSettings</code> tag in the configuration file. If the application is named <code>myFancyApp.exe</code> then the configuration file is usually named <code>myFancyApp.exe.config</code>.</p>

<p>I have written about configuration files before in context of proxying. More background material here:</p>

<ul>
<li><a href="/blog/2017-10-07-thick-client-proxying-part-7-proxying-.net-applications-via-config-file/" title="Thick Client Proxying - Part 7 - Proxying .NET Applications via Config File" rel="nofollow" target="_blank">Thick Client Proxying - Part 7 - Proxying .NET Applications via Config File</a>.</li>
</ul>

<p>Open the configuration file <code>dvta-master\DVTA\DVTA\bin\Release\DVTA.exe.config</code> and look inside. It's an XML file with an <code>appSettings</code> section:</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#268bd2">&lt;appSettings&gt;</span>
    <span style="color:#268bd2">&lt;add</span> key=<span style="color:#2aa198">&#34;DBSERVER&#34;</span> value=<span style="color:#2aa198">&#34;127.0.0.1\SQLEXPRESS&#34;</span> <span style="color:#268bd2">/&gt;</span>
    <span style="color:#268bd2">&lt;add</span> key=<span style="color:#2aa198">&#34;DBNAME&#34;</span> value=<span style="color:#2aa198">&#34;DVTA&#34;</span> <span style="color:#268bd2">/&gt;</span>
    <span style="color:#268bd2">&lt;add</span> key=<span style="color:#2aa198">&#34;DBUSERNAME&#34;</span> value=<span style="color:#2aa198">&#34;sa&#34;</span> <span style="color:#268bd2">/&gt;</span>
    <span style="color:#268bd2">&lt;add</span> key=<span style="color:#2aa198">&#34;DBPASSWORD&#34;</span> value=<span style="color:#2aa198">&#34;CTsvjZ0jQghXYWbSRcPxpQ==&#34;</span> <span style="color:#268bd2">/&gt;</span>
    <span style="color:#268bd2">&lt;add</span> key=<span style="color:#2aa198">&#34;AESKEY&#34;</span> value=<span style="color:#2aa198">&#34;J8gLXc454o5tW2HEF7HahcXPufj9v8k8&#34;</span> <span style="color:#268bd2">/&gt;</span>
    <span style="color:#268bd2">&lt;add</span> key=<span style="color:#2aa198">&#34;IV&#34;</span> value=<span style="color:#2aa198">&#34;fq20T0gMnXa6g0l4&#34;</span> <span style="color:#268bd2">/&gt;</span>
    <span style="color:#268bd2">&lt;add</span> key=<span style="color:#2aa198">&#34;ClientSettingsProvider.ServiceUri&#34;</span> value=<span style="color:#2aa198">&#34;&#34;</span> <span style="color:#268bd2">/&gt;</span>
<span style="color:#268bd2">&lt;/appSettings&gt;</span></code></pre></div>
<p>As you can guess, <code>DBPASSWORD</code> is base64 encoded and encrypted. We can decrypt it with this program on Go playground: <a href="https://play.golang.org/p/7Vjw2Asr4Lo" rel="nofollow" target="_blank">https://play.golang.org/p/7Vjw2Asr4Lo</a>.</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#719e07">package</span> main

<span style="color:#719e07">import</span> (
	<span style="color:#2aa198">&#34;fmt&#34;</span>
	<span style="color:#2aa198">&#34;crypto/aes&#34;</span>
	<span style="color:#2aa198">&#34;encoding/base64&#34;</span>
	<span style="color:#2aa198">&#34;crypto/cipher&#34;</span>
)

<span style="color:#268bd2">func</span> <span style="color:#268bd2">main</span>() {
	dbPassword, err <span style="color:#719e07">:=</span> base64.StdEncoding.<span style="color:#268bd2">DecodeString</span>(<span style="color:#2aa198">&#34;CTsvjZ0jQghXYWbSRcPxpQ==&#34;</span>)
	<span style="color:#719e07">if</span> err <span style="color:#719e07">!=</span> <span style="color:#cb4b16">nil</span> {
		<span style="color:#b58900">panic</span>(err)
	}
	aesKey <span style="color:#719e07">:=</span> []<span style="color:#b58900">byte</span>(<span style="color:#2aa198">&#34;J8gLXc454o5tW2HEF7HahcXPufj9v8k8&#34;</span>)
	iv <span style="color:#719e07">:=</span> []<span style="color:#b58900">byte</span>(<span style="color:#2aa198">&#34;fq20T0gMnXa6g0l4&#34;</span>)


	cb, err <span style="color:#719e07">:=</span> aes.<span style="color:#268bd2">NewCipher</span>(aesKey)
	<span style="color:#719e07">if</span> err <span style="color:#719e07">!=</span> <span style="color:#cb4b16">nil</span> {
		<span style="color:#b58900">panic</span>(err)
	}
	mode <span style="color:#719e07">:=</span> cipher.<span style="color:#268bd2">NewCBCDecrypter</span>(cb, iv)
	
	dec <span style="color:#719e07">:=</span> <span style="color:#b58900">make</span>([]<span style="color:#dc322f">byte</span>, <span style="color:#b58900">len</span>(dbPassword))
	mode.<span style="color:#268bd2">CryptBlocks</span>(dec, dbPassword)
	
	fmt.<span style="color:#268bd2">Printf</span>(<span style="color:#2aa198">&#34;% x\n&#34;</span>, dec)
	fmt.<span style="color:#268bd2">Printf</span>(<span style="color:#2aa198">&#34;%s&#34;</span>, dec)
}</code></pre></div>
<p>Result is (note the <a href="https://tools.ietf.org/html/rfc5652#section-6.3" rel="nofollow" target="_blank">PKCS#7</a> padding):</p>
<pre><code>70 40 73 73 77 30 72 64 08 08 08 08 08 08 08 08
p@ssw0rd</code></pre>
<p>If we did not know the algorithm, we had to investigate in dnSpy. Click on <code>decryptPassword</code>:</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#719e07">public</span> <span style="color:#dc322f">string</span> decryptPassword()
{
    <span style="color:#dc322f">string</span> s = ConfigurationManager.AppSettings[<span style="color:#2aa198">&#34;DBPASSWORD&#34;</span>].ToString();
    <span style="color:#dc322f">string</span> key = ConfigurationManager.AppSettings[<span style="color:#2aa198">&#34;AESKEY&#34;</span>].ToString();
    <span style="color:#dc322f">string</span> IV = ConfigurationManager.AppSettings[<span style="color:#2aa198">&#34;IV&#34;</span>].ToString();
    <span style="color:#dc322f">byte</span>[] encryptedBytes = Convert.FromBase64String(s);
    AesCryptoServiceProvider aes = <span style="color:#719e07">new</span> AesCryptoServiceProvider();
    aes.BlockSize = <span style="color:#2aa198">128</span>;
    aes.KeySize = <span style="color:#2aa198">256</span>;
    aes.Key = Encoding.ASCII.GetBytes(key);
    aes.IV = Encoding.ASCII.GetBytes(IV);
    aes.Padding = PaddingMode.PKCS7;
    aes.Mode = CipherMode.CBC;
    <span style="color:#dc322f">byte</span>[] decryptedbytes = aes.CreateDecryptor(aes.Key, aes.IV).TransformFinalBlock(encryptedBytes, <span style="color:#2aa198">0</span>, encryptedBytes.Length);
    <span style="color:#719e07">this</span>.decryptedDBPassword = Encoding.ASCII.GetString(decryptedbytes);
    Console.WriteLine(<span style="color:#719e07">this</span>.decryptedDBPassword);
    <span style="color:#719e07">return</span> <span style="color:#719e07">this</span>.decryptedDBPassword;
}</code></pre></div>
<p>Which is similar to what we did. Note it's also printed to console.</p>

<h1 id="local-file-access">Local File Access</h1>

<p>What else is there? Applications usually store information in local files and the registry. We can use procmon to view their filesystem activity. Start procmon and then the application. In procmon, only keep the <code>Process Name is dvta.exe</code> filter and remove our previous ones. Then use the menu buttons to only <code>Show File System Activity</code>. It's beside the <code>Network Activity</code> button that we used before.</p>






<span class="caption-wrapper">
  <img class="caption" src="img/04.png" title="Enabling Network Activity" alt="Enabling Network Activity">
  <span class="caption-text">Enabling Network Activity</span>
</span>


<p>procmon displays files accessed by the application:</p>






<span class="caption-wrapper">
  <img class="caption" src="img/05.png" title="Reading the config file" alt="Reading the config file">
  <span class="caption-text">Reading the config file</span>
</span>


<p>To reduce clutter, you can add filters and exclude paths.</p>

<p>Play with the application and sign-in with a few different users, Unfortunately it seems like the application does not store any information in local files. However, do not close procmon because we are going to do some DLL hijacking.</p>

<h1 id="dll-hijacking">DLL Hijacking</h1>

<p>There are a lot of articles that explain it much better than me so I am going to do a short description and then link to resources. DLL hijacking happens when the application is looking for a DLL not via an absolute path. This means Windows will search for the DLL is specific paths starting with the root directory of the application. If it's not found in one, it will move on to the other. If attackers have write access to one of those paths (that is higher on the search hierarchy than where the actual DLL is), they can put a malicious DLL there and effectively take control of the application.</p>

<p>Some links from Microsoft:</p>

<ul>
<li>Search order for desktop applications: <a href="https://docs.microsoft.com/en-us/windows/desktop/dlls/dynamic-link-library-search-order#search-order-for-desktop-applications" rel="nofollow" target="_blank">https://docs.microsoft.com/en-us/windows/desktop/dlls/dynamic-link-library-search-order#search-order-for-desktop-applications</a></li>
<li>Dynamic link library security: <a href="https://docs.microsoft.com/en-us/windows/desktop/dlls/dynamic-link-library-security" rel="nofollow" target="_blank">https://docs.microsoft.com/en-us/windows/desktop/dlls/dynamic-link-library-security</a></li>
</ul>

<p>You can find so many more with a search.</p>

<h2 id="step-1-identifying-dlls">Step 1: Identifying DLLs</h2>

<p>First, we need to figure out which DLLs are vulnerable to hijacking. I am going to show two ways.</p>

<h3 id="procmon">Procmon</h3>

<p>To discover DLL hijacking entry points, we can use procmon. Add these filters:</p>

<ul>
<li><code>Process Name contains DVTA</code></li>
<li><code>Result is NAME NOT FOUND</code></li>
<li>(optional) <code>Path ends with dll</code></li>
</ul>






<span class="caption-wrapper">
  <img class="caption" src="img/06.png" title="Procmon filters for DLL hijacking" alt="Procmon filters for DLL hijacking">
  <span class="caption-text">Procmon filters for DLL hijacking</span>
</span>


<p>A lot of results pop up:</p>






<span class="caption-wrapper">
  <img class="caption" src="img/07.png" title="NAME NOT FOUND results" alt="NAME NOT FOUND results">
  <span class="caption-text">NAME NOT FOUND results</span>
</span>


<p>The application is looking for these DLLs in the current directory (or other paths) and cannot find them. This means, Windows will search for these DLLs on the machine according to the search order.</p>

<h3 id="find-processdllhijack-from-powersploit">Find-ProcessDLLHijack from PowerSploit</h3>

<p><a href="https://github.com/PowerShellMafia/PowerSploit" rel="nofollow" target="_blank">PowerSploit</a> also has utilities for identifying (and performing) DLL hijacking.</p>

<p>To install PowerSploit:</p>

<ol>
<li>Clone the repository (or download it as a zip file) at <a href="https://github.com/PowerShellMafia/PowerSploit" rel="nofollow" target="_blank">https://github.com/PowerShellMafia/PowerSploit</a>.</li>
<li>Copy the directory to <code>C:\Users\IEUser\Documents\WindowsPowerShell\Modules</code> where <code>IEUser</code> is the current user.</li>
<li>Open a PowerShell prompt as admin.</li>
<li>Run <code>Set-ExecutionPolicy bypass</code>. This will disable all the warnings. You are running in a VM right?</li>
<li>Open a new PowerShell prompt and run <code>Import-Module PowerSploit</code>.</li>
<li>???</li>
<li>Profit.</li>
</ol>

<p>Run the application and execute the following PowerShell command (we have auto-complete):</p>

<ul>
<li><code>Find-ProcessDLLHijack DVTA-v3 | Format-List</code></li>
</ul>

<p>I have patched the utility three times, so my executable is named <code>DVTA-v3</code>. Replace it with your process name.</p>






<span class="caption-wrapper">
  <img class="caption" src="img/08.png" title="Hijackable DLLs according to PowerSploit" alt="Hijackable DLLs according to PowerSploit">
  <span class="caption-text">Hijackable DLLs according to PowerSploit</span>
</span>


<h2 id="step-2-checking-write-permissions">Step 2: Checking Write Permissions</h2>

<p>Without write access to somewhere high enough in the search path to replace the DLL, we cannot do anything. In our sample setup, this is not a problem because we most likely have admin on the machine. In the real world, be sure to check ACLs for write access.</p>

<p>There are also other paths, <code>Find-PathDLLHijack</code> can identify them.</p>






<span class="caption-wrapper">
  <img class="caption" src="img/09.png" title="Paths with Write Access" alt="Paths with Write Access">
  <span class="caption-text">Paths with Write Access</span>
</span>


<h2 id="step-3-deploying-the-malicious-dll">Step 3: Deploying the Malicious DLL</h2>

<p>Now we need to write it to the path identified in the previous section with <code>Write-HijackDll</code>. I chose <code>VERSION.dll</code>.</p>

<p>We can deploy with PowerSploit using <code>Write-HijackDll</code>. It creates a bat file, runs the command in it and deletes itself. We can specify the bat file path with <code>-BatPath</code> and the command with <code>-Command</code>:</p>

<ul>
<li><code>Write-HijackDll -BatPath b.bat -Command &quot;copy NUL testfile.txt&quot;</code></li>
</ul>






<span class="caption-wrapper">
  <img class="caption" src="img/13.png" title="Deploying the DLL with Wire-HijackDll" alt="Deploying the DLL with Wire-HijackDll">
  <span class="caption-text">Deploying the DLL with Wire-HijackDll</span>
</span>


<p>We run the application and nothing happens. Why? Let's investigate with procmon.</p>

<p>Disable the <code>NAME NOT FOUND</code> filter and add a new filter <code>Path contains version.dll</code>.</p>






<span class="caption-wrapper">
  <img class="caption" src="img/11.png" title="Path contains version.dll filter" alt="Path contains version.dll filter">
  <span class="caption-text">Path contains version.dll filter</span>
</span>


<p>Which shows us that <code>version.dll</code> was found in <code>System32</code>. Our malicious DLL was not high enough on the DLL search order hierarchy.</p>






<span class="caption-wrapper">
  <img class="caption" src="img/12.png" title="version.dll found in System32" alt="version.dll found in System32">
  <span class="caption-text">version.dll found in System32</span>
</span>


<p>We need to deploy the DLL to the application directory. I also learned another lesson, either store the bat file in the same directory as the DLL or provide the full path when running <code>Write-HijackDll</code>. This time I also changed the payload to pop <code>calc.exe</code>.</p>






<span class="caption-wrapper">
  <img class="caption" src="img/14.png" title="Running Write-HijackDll again" alt="Running Write-HijackDll again">
  <span class="caption-text">Running Write-HijackDll again</span>
</span>


<p>And run the application again.</p>






<span class="caption-wrapper">
  <img class="caption" src="img/15.png" title="Calc executed" alt="Calc executed">
  <span class="caption-text">Calc executed</span>
</span>


<h1 id="registry-hives">Registry Hives</h1>

<p>Registry hives are also popular places for storing information. Procmon allows us to monitor registry activity too. Run procmon and keep the <code>Process Name contains dvta</code> filter. Disable all other filters from before. Enable registry activity with the <code>Show Registry Activity</code> button. It is to the left of the file activity one.</p>






<span class="caption-wrapper">
  <img class="caption" src="img/16.png" title="Show registry activity button" alt="Show registry activity button">
  <span class="caption-text">Show registry activity button</span>
</span>


<p>Run the application and see the registry keys that are accessed.</p>






<span class="caption-wrapper">
  <img class="caption" src="img/17.png" title="Registry activity in procmon" alt="Registry activity in procmon">
  <span class="caption-text">Registry activity in procmon</span>
</span>


<p>But this is too much, we only want to see what registry keys are created or modified. Add a new filter <code>Operation is RegSetValue</code> (you can also add <code>RegCreateKey</code>). Login to the application and see the important events roll in.</p>






<span class="caption-wrapper">
  <img class="caption" src="img/18.png" title="Registry keys modified by the app" alt="Registry keys modified by the app">
  <span class="caption-text">Registry keys modified by the app</span>
</span>


<p>The application writes password and other information to the registry at <code>HKCU\dvta</code>. These keys are also not erased when the user exits.</p>






<span class="caption-wrapper">
  <img class="caption" src="img/19.png" title="DVTA registry keys" alt="DVTA registry keys">
  <span class="caption-text">DVTA registry keys</span>
</span>


<h1 id="conclusion">Conclusion</h1>

<p>That was it for part five. We learned how to look at client-side storage, trace registry activity, and did a bit of DLL hijacking. At this point I think I am done with this app. I might have missed some parts.</p>

<p>I hope this helped. Thanks for reading this and if you have any questions/feedback, you know where to find me.</p>
        </div>
        

<footer>
  <p class="meta">
    <span class="byline author vcard">Posted by <span class="fn">Parsia</span></span>
    
    <time>Aug 25, 2018</time>
    
      <span class="categories">
        Tags:
        
          <a class="category" href="http://localhost:1313/tags/dnspy">dnSpy</a>  
    
    </span>
  </p>

  

  <p class="meta">
    
        <a class="basic-alignment left" href="http://localhost:1313/blog/2018-08-23-committing-insurance-fraud-with-tineola/" title="Committing Insurance Fraud with Tineola">Committing Insurance Fraud with Tineola</a>
    

    
      <a class="basic-alignment right" href="http://localhost:1313/blog/2018-09-27-tineola-taking-a-bite-out-of-enterprise-blockchain/" title="Tineola: Taking a Bite out of Enterprise Blockchain">Tineola: Taking a Bite out of Enterprise Blockchain</a>
    
  </p>
  
    
      <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "parsiya" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    
  
</footer>

      </article>
    </div>
    

<aside class="sidebar thirds">
  <section class="first odd">

    
      <h1>Who am I?</h1>
    

    <p>
      
        <p>I am Pitchaimuthu Muthaiya, a senior security engineer.</p>

<p>I write about application tamil words and roots of words.</p>

<p>Click on <a href="/about/">About Me!</a> to know more.</p>

      
    </p>
  </section>



  
  <ul class="sidebar-nav">
    <li class="sidebar-nav-item">
      <a target="_blank" rel="noopener noreferrer" href="https://github.com/parsiya/" title="https://github.com/parsiya/"><i class="fa fa-github fa-3x"></i></a>
      
      
      <a target="_blank" rel="noopener noreferrer" href="https://twitter.com/cryptogangsta/" title="https://twitter.com/cryptogangsta/"><i class="fa fa-twitter fa-3x"></i></a>
      
        <a target="_blank" rel="noopener noreferrer" href="https://keybase.io/parsiya/" title="https://keybase.io/parsiya/"><i class="fa fa-keybase fa-3x"></i></a> 
      
      <a target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/in/parsiya" title="https://www.linkedin.com/in/parsiya"><i class="fa fa-linkedin fa-3x"></i></a>
      
      
      
      
      

    
    
    </li>
  </ul>

  

  
    
      <section class="odd">
        
          <h1>Collections</h1>
        
        
          <li>
            <a href="http://localhost:1313/categories/thick-client-proxying/" title="Thick Client Proxying" >Thick Client Proxying</a>
          </li>
        
          <li>
            <a href="http://localhost:1313/categories/writeup/" title="CTFs/Writeups" >CTFs/Writeups</a>
          </li>
        
          <li>
            <a href="http://localhost:1313/categories/attack-surface-analysis/" title="Attack Surface Analysis" >Attack Surface Analysis</a>
          </li>
        
          <li>
            <a href="http://localhost:1313/categories/bug-bounty/" title="Bug Bounty" >Bug Bounty</a>
          </li>
        
          <li>
            <a href="http://localhost:1313/categories/go/" title="Go/Golang" >Go/Golang</a>
          </li>
        
          <li>
            <a href="http://localhost:1313/categories/blockchain/" title="Blockchain" >Blockchain</a>
          </li>
        
          <li>
            <a href="http://localhost:1313/categories/burp-extension/" title="Burp Extension Development" >Burp Extension Development</a>
          </li>
        
          <li>
            <a href="http://localhost:1313/categories/automation/" title="Automation" >Automation</a>
          </li>
        
          <li>
            <a href="http://localhost:1313/categories/reverse-engineering/" title="Reverse Engineering" >Reverse Engineering</a>
          </li>
        
          <li>
            <a href="http://localhost:1313/categories/crypto/" title="Crypto(graphy)" >Crypto(graphy)</a>
          </li>
        
          <li>
            <a href="http://localhost:1313/categories/winappdbg/" title="WinAppDbg" >WinAppDbg</a>
          </li>
        
          <li>
            <a href="https://awsome.pw" title="AWSome.pw - S3 bucket squatting - my very legit branded vulnerability" >AWSome.pw - S3 bucket squatting - my very legit branded vulnerability</a>
          </li>
        
      </section>
    
  

  
  
  
</aside>

  </div>
</div>

    <footer role="contentinfo">
      <p>Copyright &copy; 2021 Parsia - <a href="http://localhost:1313/license/">License</a> -
        <span class="credit">Powered by <a target="_blank" href="https://gohugo.io" rel="noopener noreferrer">Hugo</a> and <a target="_blank" href="https://github.com/parsiya/hugo-octopress/" rel="noopener noreferrer">Hugo-Octopress</a> theme.
      </p>
    </footer>

    
    



    
    
    

    
  </body>
</html>

